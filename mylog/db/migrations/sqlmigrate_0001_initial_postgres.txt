BEGIN;
--
-- Create model Curator
--
CREATE TABLE "Curator" ("name" varchar(35) NOT NULL, "last_name" varchar(35) NOT NULL, "patronymic" varchar(35) NOT NULL, "description" varchar(200) NOT NULL, "id" serial NOT NULL PRIMARY KEY, "credentials_id" integer NOT NULL UNIQUE);
--
-- Create model Skill
--
CREATE TABLE "Skill" ("id" serial NOT NULL PRIMARY KEY, "name" varchar(100) NOT NULL);
--
-- Create model Student
--
CREATE TABLE "Student" ("name" varchar(35) NOT NULL, "last_name" varchar(35) NOT NULL, "patronymic" varchar(35) NOT NULL, "description" varchar(200) NOT NULL, "id" serial NOT NULL PRIMARY KEY, "credentials_id" integer NOT NULL UNIQUE);
CREATE TABLE "Student_skills" ("id" serial NOT NULL PRIMARY KEY, "student_id" integer NOT NULL, "skill_id" integer NOT NULL);
--
-- Create model Subject
--
CREATE TABLE "Subject" ("id" serial NOT NULL PRIMARY KEY, "name" varchar(100) NOT NULL);
--
-- Create model SuggestionTheme
--
CREATE TABLE "Suggestion_theme" ("id" serial NOT NULL PRIMARY KEY, "date_creation" timestamp with time zone NOT NULL, "curator_id" integer NULL);
--
-- Create model SuggestionThemeComment
--
CREATE TABLE "Suggestion_theme_comment" ("author_name" varchar(35) NOT NULL, "content" varchar(200) NOT NULL, "date_creation" timestamp with time zone NOT NULL, "id" serial NOT NULL PRIMARY KEY, "suggestion_id" integer NOT NULL);
--
-- Create model SuggestionThemeProgress
--
CREATE TABLE "Suggestion_theme_progress" ("id" serial NOT NULL PRIMARY KEY, "title" varchar(75) NOT NULL, "description" varchar(150) NOT NULL, "date_update" timestamp with time zone NULL);
--
-- Create model SuggestionThemeStatus
--
CREATE TABLE "Suggestion_theme_status" ("id" serial NOT NULL PRIMARY KEY, "name" varchar(50) NOT NULL);
--
-- Create model Theme
--
CREATE TABLE "Theme" ("id" serial NOT NULL PRIMARY KEY, "title" varchar(100) NOT NULL, "description" varchar(250) NOT NULL, "date_creation" timestamp with time zone NOT NULL, "date_acceptance" timestamp with time zone NULL, "curator_id" integer NULL, "student_id" integer NULL, "subject_id" integer NULL);
CREATE TABLE "Theme_skills" ("id" serial NOT NULL PRIMARY KEY, "theme_id" integer NOT NULL, "skill_id" integer NOT NULL);
--
-- Create model Work
--
CREATE TABLE "Work" ("id" serial NOT NULL PRIMARY KEY, "date_start" timestamp with time zone NOT NULL, "date_finish" timestamp with time zone NULL, "theme_id" integer NOT NULL);
--
-- Create model WorkStep
--
CREATE TABLE "Work_step" ("id" serial NOT NULL PRIMARY KEY, "title" varchar(100) NOT NULL, "description" varchar(250) NOT NULL, "date_start" timestamp with time zone NOT NULL, "date_finish" timestamp with time zone NOT NULL);
--
-- Create model WorkStepComment
--
CREATE TABLE "Work_step_comment" ("author_name" varchar(35) NOT NULL, "content" varchar(200) NOT NULL, "date_creation" timestamp with time zone NOT NULL, "id" serial NOT NULL PRIMARY KEY, "work_step_id" integer NOT NULL);
--
-- Create model WorkStepMaterial
--
CREATE TABLE "Work_step_material" ("id" serial NOT NULL PRIMARY KEY, "content" varchar(200) NOT NULL, "step_id" integer NOT NULL);
--
-- Create model WorkStepStatus
--
CREATE TABLE "Work_step_status" ("id" serial NOT NULL PRIMARY KEY, "name" varchar(50) NOT NULL);
--
-- Add field status to workstep
--
ALTER TABLE "Work_step" ADD COLUMN "status_id" integer NOT NULL;
--
-- Add field work to workstep
--
ALTER TABLE "Work_step" ADD COLUMN "work_id" integer NOT NULL;
--
-- Add field progress to suggestiontheme
--
ALTER TABLE "Suggestion_theme" ADD COLUMN "progress_id" integer NULL;
--
-- Add field status to suggestiontheme
--
ALTER TABLE "Suggestion_theme" ADD COLUMN "status_id" integer NOT NULL;
--
-- Add field student to suggestiontheme
--
ALTER TABLE "Suggestion_theme" ADD COLUMN "student_id" integer NULL;
--
-- Add field theme to suggestiontheme
--
ALTER TABLE "Suggestion_theme" ADD COLUMN "theme_id" integer NOT NULL;
--
-- Add field skills to curator
--
CREATE TABLE "Curator_skills" ("id" serial NOT NULL PRIMARY KEY, "curator_id" integer NOT NULL, "skill_id" integer NOT NULL);
ALTER TABLE "Curator" ADD CONSTRAINT "Curator_credentials_id_f66e36ab_fk_auth_user_id" FOREIGN KEY ("credentials_id") REFERENCES "auth_user" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "Student" ADD CONSTRAINT "Student_credentials_id_747a04d8_fk_auth_user_id" FOREIGN KEY ("credentials_id") REFERENCES "auth_user" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "Student_skills" ADD CONSTRAINT "Student_skills_student_id_4cf86b59_fk_Student_id" FOREIGN KEY ("student_id") REFERENCES "Student" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "Student_skills" ADD CONSTRAINT "Student_skills_skill_id_5e48bf79_fk_Skill_id" FOREIGN KEY ("skill_id") REFERENCES "Skill" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "Student_skills" ADD CONSTRAINT "Student_skills_student_id_skill_id_3a1e7fc9_uniq" UNIQUE ("student_id", "skill_id");
CREATE INDEX "Student_skills_student_id_4cf86b59" ON "Student_skills" ("student_id");
CREATE INDEX "Student_skills_skill_id_5e48bf79" ON "Student_skills" ("skill_id");
ALTER TABLE "Suggestion_theme" ADD CONSTRAINT "Suggestion_theme_curator_id_0a36d856_fk_Curator_id" FOREIGN KEY ("curator_id") REFERENCES "Curator" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "Suggestion_theme_curator_id_0a36d856" ON "Suggestion_theme" ("curator_id");
ALTER TABLE "Suggestion_theme_comment" ADD CONSTRAINT "Suggestion_theme_com_suggestion_id_9dd9fc98_fk_Suggestio" FOREIGN KEY ("suggestion_id") REFERENCES "Suggestion_theme" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "Suggestion_theme_comment_suggestion_id_9dd9fc98" ON "Suggestion_theme_comment" ("suggestion_id");
ALTER TABLE "Theme" ADD CONSTRAINT "Theme_curator_id_b807b49a_fk_Curator_id" FOREIGN KEY ("curator_id") REFERENCES "Curator" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "Theme" ADD CONSTRAINT "Theme_student_id_56dd59b2_fk_Student_id" FOREIGN KEY ("student_id") REFERENCES "Student" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "Theme" ADD CONSTRAINT "Theme_subject_id_24550eb8_fk_Subject_id" FOREIGN KEY ("subject_id") REFERENCES "Subject" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "Theme_curator_id_b807b49a" ON "Theme" ("curator_id");
CREATE INDEX "Theme_student_id_56dd59b2" ON "Theme" ("student_id");
CREATE INDEX "Theme_subject_id_24550eb8" ON "Theme" ("subject_id");
ALTER TABLE "Theme_skills" ADD CONSTRAINT "Theme_skills_theme_id_46898d65_fk_Theme_id" FOREIGN KEY ("theme_id") REFERENCES "Theme" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "Theme_skills" ADD CONSTRAINT "Theme_skills_skill_id_c455e883_fk_Skill_id" FOREIGN KEY ("skill_id") REFERENCES "Skill" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "Theme_skills" ADD CONSTRAINT "Theme_skills_theme_id_skill_id_1b4ec720_uniq" UNIQUE ("theme_id", "skill_id");
CREATE INDEX "Theme_skills_theme_id_46898d65" ON "Theme_skills" ("theme_id");
CREATE INDEX "Theme_skills_skill_id_c455e883" ON "Theme_skills" ("skill_id");
ALTER TABLE "Work" ADD CONSTRAINT "Work_theme_id_eaade071_fk_Theme_id" FOREIGN KEY ("theme_id") REFERENCES "Theme" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "Work_theme_id_eaade071" ON "Work" ("theme_id");
ALTER TABLE "Work_step_comment" ADD CONSTRAINT "Work_step_comment_work_step_id_ecc2d35e_fk_Work_step_id" FOREIGN KEY ("work_step_id") REFERENCES "Work_step" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "Work_step_comment_work_step_id_ecc2d35e" ON "Work_step_comment" ("work_step_id");
ALTER TABLE "Work_step_material" ADD CONSTRAINT "Work_step_material_step_id_c722cd5f_fk_Work_step_id" FOREIGN KEY ("step_id") REFERENCES "Work_step" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "Work_step_material_step_id_c722cd5f" ON "Work_step_material" ("step_id");
CREATE INDEX "Work_step_status_id_e8a0c444" ON "Work_step" ("status_id");
ALTER TABLE "Work_step" ADD CONSTRAINT "Work_step_status_id_e8a0c444_fk_Work_step_status_id" FOREIGN KEY ("status_id") REFERENCES "Work_step_status" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "Work_step_work_id_fd227757" ON "Work_step" ("work_id");
ALTER TABLE "Work_step" ADD CONSTRAINT "Work_step_work_id_fd227757_fk_Work_id" FOREIGN KEY ("work_id") REFERENCES "Work" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "Suggestion_theme_progress_id_94e6bd86" ON "Suggestion_theme" ("progress_id");
ALTER TABLE "Suggestion_theme" ADD CONSTRAINT "Suggestion_theme_progress_id_94e6bd86_fk_Suggestio" FOREIGN KEY ("progress_id") REFERENCES "Suggestion_theme_progress" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "Suggestion_theme_status_id_600846c8" ON "Suggestion_theme" ("status_id");
ALTER TABLE "Suggestion_theme" ADD CONSTRAINT "Suggestion_theme_status_id_600846c8_fk_Suggestio" FOREIGN KEY ("status_id") REFERENCES "Suggestion_theme_status" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "Suggestion_theme_student_id_27921146" ON "Suggestion_theme" ("student_id");
ALTER TABLE "Suggestion_theme" ADD CONSTRAINT "Suggestion_theme_student_id_27921146_fk_Student_id" FOREIGN KEY ("student_id") REFERENCES "Student" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "Suggestion_theme_theme_id_a5cdf114" ON "Suggestion_theme" ("theme_id");
ALTER TABLE "Suggestion_theme" ADD CONSTRAINT "Suggestion_theme_theme_id_a5cdf114_fk_Theme_id" FOREIGN KEY ("theme_id") REFERENCES "Theme" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "Curator_skills" ADD CONSTRAINT "Curator_skills_curator_id_e56cbb05_fk_Curator_id" FOREIGN KEY ("curator_id") REFERENCES "Curator" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "Curator_skills" ADD CONSTRAINT "Curator_skills_skill_id_fec572d0_fk_Skill_id" FOREIGN KEY ("skill_id") REFERENCES "Skill" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "Curator_skills" ADD CONSTRAINT "Curator_skills_curator_id_skill_id_caa89ac3_uniq" UNIQUE ("curator_id", "skill_id");
CREATE INDEX "Curator_skills_curator_id_e56cbb05" ON "Curator_skills" ("curator_id");
CREATE INDEX "Curator_skills_skill_id_fec572d0" ON "Curator_skills" ("skill_id");
COMMIT;
